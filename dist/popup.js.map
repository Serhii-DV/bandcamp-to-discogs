{"version":3,"file":"popup.js","mappings":"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","sources":["webpack:///./src/modules/utils.js","webpack:///./src/discogs/modules/genres.js","webpack:///./src/bandcamp/modules/mapping.js","webpack:///./src/bandcamp/modules/bandcamp.js","webpack:///./src/discogs/app/utils.js","webpack:///./src/discogs/app/discogs-csv.js","webpack:///./src/config.js","webpack:///./src/discogs/modules/discogs.js","webpack:///./src/modules/chrome.js","webpack:///./node_modules/uuid/dist/esm-browser/stringify.js","webpack:///./node_modules/uuid/dist/esm-browser/regex.js","webpack:///./node_modules/uuid/dist/esm-browser/parse.js","webpack:///./node_modules/uuid/dist/esm-browser/validate.js","webpack:///./node_modules/uuid/dist/esm-browser/sha1.js","webpack:///./node_modules/uuid/dist/esm-browser/v5.js","webpack:///./node_modules/uuid/dist/esm-browser/v35.js","webpack:///./src/modules/key-generator.js","webpack:///./src/app/trackTime.js","webpack:///./src/app/release.js","webpack:///./src/modules/csv.js","webpack:///./src/modules/html.js","webpack:///./src/modules/storage.js","webpack:///./src/popup/helpers.js","webpack:///./src/popup/tabs/history_tab.js","webpack:///./src/popup/tabs/download_tab.js","webpack:///./src/popup/tabs/releases_tab.js","webpack:///./src/utils/clipboard.js","webpack:///./src/popup/tabs/release_tab.js","webpack:///./src/popup/tabs/csv_data_tab.js","webpack:///./src/popup/console.js","webpack:///./src/popup/popup.js"],"sourcesContent":["/**\n * @param {String} string\n * @param {String} pad\n * @param {Number} length\n * @returns {String}\n */\nexport function padStringLeft(string, pad, length) {\n  const padding = string.length >= length ? '' : pad.repeat(length - string.length);\n  return padding + string;\n}\n\n/** @see https://stackoverflow.com/a/8485137/3227570 */\nexport function safeFilename(value) {\n  return transliterate(value).replace(/[^a-zA-Z0-9]/gi, '_').toLowerCase();\n}\n\n/** @see https://stackoverflow.com/a/11404121 */\nconst transliterationMap = {\n  \"Ё\": \"YO\", \"Й\": \"I\", \"Ц\": \"TS\", \"У\": \"U\", \"К\": \"K\", \"Е\": \"E\", \"Н\": \"N\", \"Г\": \"G\", \"Ш\": \"SH\", \"Щ\": \"SCH\", \"З\": \"Z\", \"Х\": \"H\", \"Ъ\": \"'\", \"ё\": \"yo\", \"й\": \"i\", \"ц\": \"ts\", \"у\": \"u\", \"к\": \"k\", \"е\": \"e\", \"н\": \"n\", \"г\": \"g\", \"ш\": \"sh\", \"щ\": \"sch\", \"з\": \"z\", \"х\": \"h\", \"ъ\": \"'\", \"Ф\": \"F\", \"Ы\": \"I\", \"В\": \"V\", \"А\": \"A\", \"П\": \"P\", \"Р\": \"R\", \"О\": \"O\", \"Л\": \"L\", \"Д\": \"D\", \"Ж\": \"ZH\", \"Э\": \"E\", \"ф\": \"f\", \"ы\": \"i\", \"в\": \"v\", \"а\": \"a\", \"п\": \"p\", \"р\": \"r\", \"о\": \"o\", \"л\": \"l\", \"д\": \"d\", \"ж\": \"zh\", \"э\": \"e\", \"Я\": \"Ya\", \"Ч\": \"CH\", \"С\": \"S\", \"М\": \"M\", \"И\": \"I\", \"Т\": \"T\", \"Ь\": \"'\", \"Б\": \"B\", \"Ю\": \"YU\", \"я\": \"ya\", \"ч\": \"ch\", \"с\": \"s\", \"м\": \"m\", \"и\": \"i\", \"т\": \"t\", \"ь\": \"'\", \"б\": \"b\", \"ю\": \"yu\"\n};\n\nfunction transliterate(word) {\n  return Array.from(word).map(char => transliterationMap[char] || char).join(\"\");\n}\n\n/** @see https://flexiple.com/javascript/javascript-capitalize-first-letter/ */\nexport function capitalizeEachWord(str) {\n  const words = str.split(\" \");\n\n  const capitalizedWords = words.map(word => {\n    const firstLetter = word.charAt(0).toUpperCase();\n    const restOfWord = word.slice(1);\n    return `${firstLetter}${restOfWord}`;\n  });\n\n  return capitalizedWords.join(\" \");\n}\n\nexport function convertToAlias(str) {\n  const slug = str.toLowerCase().replace(/[^a-z0-9]+/g, '-');\n  const trimmedSlug = slug.replace(/^-+|-+$/g, '');\n  return trimmedSlug;\n}\n\nexport function isEmptyObject(obj) {\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\nexport function isObject(value) {\n  return Object.prototype.toString.call(value) === '[object Object]';\n}\n\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * @param {Array} value\n * @returns {Boolean}\n */\nexport function isEmptyArray(value) {\n  return !isArray(value) || value.length === 0;\n}\n\n/**\n * @param {Array<Array<String>>}\n * @return {Array<String>}\n */\nexport function arrayToFlat(arr) {\n  return [].concat(...arr);\n}\n\n/**\n * @param {Array<Array<String>|String>}\n * @return {Array<String>}\n */\nexport function arrayUnique(arr) {\n  return [...new Set(arrayToFlat(arr))];\n}\n\n/**\n * @param {Element} element\n * @param {String} className\n * @returns {Boolean}\n */\nexport function hasClass(element, className) {\n  return element.classList.contains(className);\n}\n\n/**\n * @param {String} url\n * @param {Element} targetElement\n * @returns {Promise}\n */\nexport function loadHTMLContent(url, targetElement) {\n  return fetch(url)\n      .then(response => response.text())\n      .then(htmlContent => {\n          targetElement.innerHTML = htmlContent;\n          return targetElement;\n      })\n      .catch(error => console.error('Error loading HTML content:', error));\n}\n\n/**\n * Replace tokens in a template string with their corresponding values.\n * @param {string} template - The template string with tokens to be replaced.\n * @param {object} replacements - An object containing key-value pairs for replacements.\n * @returns {string} - The template string with tokens replaced by their values.\n */\nexport function replaceTokens(template, replacements) {\n  for (const key in replacements) {\n    if (replacements.hasOwnProperty(key)) {\n      template = template.replace(`{${key}}`, replacements[key]);\n    }\n  }\n  return template;\n}\n\n/**\n * @param {String} cssUrl\n */\nexport function injectCSSFile(cssUrl) {\n  const linkElement = document.createElement('link');\n  linkElement.rel = 'stylesheet';\n  linkElement.href = cssUrl;\n\n  document.head.appendChild(linkElement);\n}\n\nexport function injectJSFile(url, callback) {\n  const s = window.document.createElement('script');\n  s.src = url;\n  s.onload = isFunction(callback) ? callback() : () => { console.log(`B2D: Script ${url} was injected!`); };\n  (document.head||document.documentElement).appendChild(s);\n}\n\n/**\n * @param {String} inputString\n * @param {RegExp|String} delimiters\n * @returns {Array}\n */\nexport function splitString(inputString, delimiters) {\n  const resultArray = inputString.split(delimiters);\n  return resultArray\n    .map(item => item.trim())\n    .filter(item => item !== '');\n}\n\nexport function containsOneOf(string1, arrayOfStrings) {\n  // This function checks if a string contains one of the strings in an array of strings.\n\n  // Args:\n  //   string1: The string to check.\n  //   arrayOfStrings: The array of strings to look for.\n\n  // Returns:\n  //   True if string1 contains one of the strings in arrayOfStrings, False otherwise.\n\n  for (const string2 of arrayOfStrings) {\n    if (string1.includes(string2)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function countOccurrences(arr) {\n  const count = new Map();\n  const items = new Map();\n  const result = [];\n\n  // Count occurrences of each element in the array\n  for (const item of arr) {\n      const key = item.toLowerCase();\n\n      if (!items.has(key)) {\n        items.set(key, item);\n      }\n\n      count.set(key, (count.get(key) || 0) + 1);\n  }\n\n  for (const [key, item] of items) {\n    const value = count.get(key);\n    if (value > 1) {\n      result.push(`${item} (${value})`);\n    } else {\n      result.push(item);\n    }\n  }\n\n  return result;\n}\n\nexport function removeBrackets(inputString) {\n  // Use a regular expression to remove the brackets and their contents\n  return inputString.replace(/\\s*\\([^)]*\\)/, '');\n}\n\nexport function trimCharactersFromString(inputString, charactersToTrim) {\n  // Escape special characters within the provided string and construct the regex pattern\n  const escapedCharacters = charactersToTrim.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n  const regexPattern = new RegExp(`^[${escapedCharacters}]+|[${escapedCharacters}]+$`, 'g');\n  const trimmedString = inputString.replace(regexPattern, '');\n\n  return trimmedString;\n}\n\nexport function removeInvisibleChars(inputString) {\n  // Define the invisible character(s) you want to remove (for example, non-breaking space)\n  const invisibleCharsRegex = /[\\u200B-\\u200D\\uFEFF\\u200E\\u200F\\u202A-\\u202E]|&lrm;/g;\n  // Use the regular expression to remove invisible characters\n  const cleanedString = inputString.replace(invisibleCharsRegex, '');\n\n  return cleanedString;\n}\n\nexport function bytesToSize(bytes) {\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n\n  if (bytes === 0) return '0 Byte';\n\n  const i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\n  return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];\n}\n\nexport function removeLeadingZeroOrColon(str) {\n  // Use a regular expression to match leading zeros or colons\n  // and replace them with an empty string\n  return str.replace(/^(:|0)*/, '');\n}\n","/**\n * @param {String} style\n * @returns {String}\n */\nexport function getGenreByStyle(style) {\n  return getPropertyByElement(genres, style);\n}\n\nlet genres = {};\n\nexport async function loadDiscogsGenres(url) {\n  return fetch(url)\n    .then(response => response.json())\n    .then(data => {\n      genres = data;\n      return genres;\n    }).catch(reason => {\n      genres = {};\n    });\n}\n\nfunction getPropertyByElement(obj, element) {\n  for (const prop in obj) {\n    if (obj.hasOwnProperty(prop)) {\n      const subGenres = obj[prop];\n      if (subGenres.includes(element)) {\n        return prop;\n      }\n    }\n  }\n  return null; // Element not found\n}\n","import { getGenreByStyle } from \"../../discogs/modules/genres.js\";\nimport { isEmptyObject, isObject, isString } from \"../../modules/utils.js\";\n\nlet mapping = {};\n\nexport function getMapping() {\n  return mapping = isEmptyObject(mapping) ? createMapping(keywordMapping) : mapping;\n}\n\nfunction createMapping(keywordMapping) {\n  const mapping = {};\n\n  for (const key in keywordMapping) {\n    if (keywordMapping.hasOwnProperty(key)) {\n      const value = keywordMapping[key];\n      if (value !== \"\") {\n        mapping[key] = isString(value) ? new Style(value) : value;\n      }\n    }\n  }\n\n  return mapping;\n}\n\nexport class Style {\n  constructor(style) {\n    this.style = style;\n    this._genre = null;\n  }\n\n  get genre() {\n    return this._genre = (isObject(this._genre) ? this._genre : getGenreByStyle(this.style));\n  }\n}\n\nlet keywordMapping = {};\n\nexport async function loadKeywordMapping(url) {\n  return fetch(url)\n    .then(response => response.json())\n    .then(data => {\n      keywordMapping = data;\n      return keywordMapping;\n    }).catch(reason => {\n      keywordMapping = {};\n    });\n}\n","import { arrayUnique, isArray, isString } from \"../../modules/utils.js\";\nimport { Style, getMapping } from \"./mapping.js\";\n\n/**\n * @param {String} keyword\n * @returns {Array<String>}\n */\nexport function keywordToDiscogsGenre(keyword) {\n  const keywordMapping = getMapping();\n  const key = keyword.toLowerCase();\n\n  if (key in keywordMapping) {\n    const keywordMapData = keywordMapping[key];\n\n    if (keywordMapData instanceof Style) {\n      return [keywordMapData.genre];\n    }\n\n    if (isArray(keywordMapData)) {\n      return keywordsToDiscogsGenres(keywordMapData);\n    }\n\n    if (isString(keywordMapData)) {\n      return keywordToDiscogsGenre(keywordMapData);\n    }\n  }\n\n  return [];\n}\n\n/**\n * @param {String} keyword\n * @returns {Array<String>}\n */\nexport function keywordToDiscogsStyles(keyword) {\n  const keywordMapping = getMapping();\n  const key = keyword.toLowerCase();\n\n  if (key in keywordMapping) {\n    const keywordMapData = keywordMapping[key];\n\n    if (keywordMapData instanceof Style) {\n      return [keywordMapData.style];\n    }\n\n    if (isArray(keywordMapData)) {\n      return keywordsToDiscogsStyles(keywordMapData);\n    }\n\n    if (isString(keywordMapData)) {\n      return keywordToDiscogsStyles(keywordMapData);\n    }\n  }\n\n  return [];\n}\n\n/**\n * @param {Array<String>} keywords\n * @returns {Array<String>}\n */\nexport function keywordsToDiscogsGenres(keywords) {\n  return arrayUnique(keywords.map(keywordToDiscogsGenre));\n}\n\n/**\n * @param {Array<String>} keywords\n * @returns {Array<String>}\n */\nexport function keywordsToDiscogsStyles(keywords) {\n  return arrayUnique(keywords.map(keywordToDiscogsStyles));\n}\n","/**\n * Returns Discogs formatted date\n * @param {Date} date\n * @returns {String}\n */\nexport const getDiscogsDateValue = date => {\n  return date.toISOString().split('T')[0];\n};\n","import { keywordsToDiscogsGenres, keywordsToDiscogsStyles } from \"../../bandcamp/modules/bandcamp.js\";\nimport { capitalizeEachWord, removeLeadingZeroOrColon } from \"../../modules/utils.js\";\nimport { Release, Track } from \"../../app/release.js\";\nimport { getDiscogsDateValue } from \"./utils.js\";\n\n/**\n * Represents a Discogs CSV entry.\n */\nexport class DiscogsCsv {\n  /**\n   * Creates a new DiscogsCsv instance.\n   * @param {Object} params - The parameters for the DiscogsCsv.\n   * @param {String} params.artist - The artist name.\n   * @param {String} params.title - The release title.\n   * @param {String} params.label - The label name.\n   * @param {String} params.catno - The catalog number.\n   * @param {String} params.format - The release format.\n   * @param {Array<String>} params.genres - The genres associated with the release.\n   * @param {Array<String>} params.styles - The styles associated with the release.\n   * @param {Array<Track>} params.tracks - The tracks included in the release.\n   * @param {String} params.notes - Additional notes.\n   * @param {Date} params.date - The release date.\n   * @param {String} params.images - The image URLs associated with the release.\n   */\n  constructor({\n    artist,\n    title,\n    label,\n    catno,\n    format,\n    genres,\n    styles,\n    tracks,\n    notes,\n    date,\n    images\n  }) {\n    this.artist = artist;\n    this.title = title;\n    this.label = label;\n    this.catno = catno;\n    this.format = format;\n    this.genres = genres;\n    this.styles = styles;\n    this.tracks = tracks;\n    this.notes = notes;\n    this.date = date;\n    this.images = images;\n  }\n\n  /**\n   * Creates a DiscogsCsv instance from a Release object.\n   * @param {Release} release - The Release object to convert.\n   * @return {DiscogsCsv} - The converted DiscogsCsv instance.\n   */\n  static fromRelease(release) {\n    const label = release.artist === release.label ? `Not On Label (${release.artist} Self-released)` : release.label;\n\n    return new DiscogsCsv({\n      artist: release.releaseItem.artist,\n      title: release.releaseItem.title,\n      label: label,\n      catno: 'none',\n      format: 'File',\n      genres: keywordsToDiscogsGenres(release.keywords),\n      styles: keywordsToDiscogsStyles(release.keywords),\n      tracks: release.tracks,\n      notes: JSON.stringify(release.toMetadata()),\n      date: release.published,\n      images: release.image\n    });\n  }\n\n  /**\n   * Adds a genre to the release.\n   * @param {String} genre - The genre to add.\n   * @returns {DiscogsCsv} - The updated DiscogsCsv instance.\n   */\n  addGenre(genre) {\n    this.genres.push(genre);\n    return this;\n  }\n\n  /**\n   * Adds a style to the release.\n   * @param {String} style - The style to add.\n   * @returns {DiscogsCsv} - The updated DiscogsCsv instance.\n   */\n  addStyle(style) {\n    this.styles.push(style);\n    return this;\n  }\n\n  /**\n   * Adds a track to the release.\n   * @param {String} track - The track to add.\n   * @returns {DiscogsCsv} - The updated DiscogsCsv instance.\n   */\n  addTrack(track) {\n    this.tracks.push(track);\n    return this;\n  }\n\n  /**\n   * Retrieves the concatenated genre string.\n   * @returns {String} - The concatenated genre string.\n   */\n  getGenre() {\n    return this.genres.filter(genre => genre !== 'Folk, World, & Country').join(', ');\n  }\n\n  /**\n   * Retrieves the concatenated style string.\n   * @returns {String} - The concatenated style string.\n   */\n  getStyle() {\n    return this.styles.join(', ');\n  }\n\n  /**\n   * Retrieves the formatted date value\n   * @returns {String} - The discogs date value\n   */\n  getDate() {\n    return getDiscogsDateValue(this.date);\n  }\n\n  /**\n   * Converts the DiscogsCsv instance to a CSV object.\n   * @returns {Object} - The CSV object representing the csv row object.\n   */\n  toCsvObject() {\n    const tracks = this.tracks\n      .map(track => `${capitalizeEachWord(track.title)} ${removeLeadingZeroOrColon(track.time.value)}`)\n      .join(\"\\r\");\n    const notes = this.notes ? this.notes.replace(/\"/g, '\"\"') : '';\n\n    return {\n      artist: `\"${this.artist}\"`,\n      title: `\"${capitalizeEachWord(this.title)}\"`,\n      label: `\"${this.label}\"`,\n      catno: this.catno,\n      format: this.format,\n      genre: `\"${this.getGenre()}\"`,\n      style: `\"${this.getStyle()}\"`,\n      tracks: `\"${tracks}\"`,\n      notes: `\"${notes}\"`,\n      date: this.getDate(),\n      images: this.images\n    };\n  }\n}\n","export default {\n  // genres_url: 'https://gist.githubusercontent.com/Serhii-DV/14d7ec13fd15e30db1a2a8dff047abbf/raw/discogs_genres_and_styles.json',\n  genres_url: '../data/discogs_genres.json',\n  // keyword_mapping_url: '../data/keyword_mapping.json',\n  keyword_mapping_url: 'https://gist.githubusercontent.com/Serhii-DV/44181f307548aabac2703147d3c730ba/raw/mapping.json',\n  about_url: '../data/about.html',\n  extension_url: 'https://chrome.google.com/webstore/detail/bandcamp-to-discogs-b2d/hipnkehalkffbdjnbbeoefmoondaciok',\n  discogs_search_artist_url: 'https://www.discogs.com/search?q={artist}&type=artist',\n  discogs_search_release_url: 'https://www.discogs.com/search?q={artist}+{release}&type=release',\n  text: {\n    // Submission notes text\n    notes: 'This draft was created via CSV upload and Bandcamp To Discogs Google Chrome extension {extension_url}\\n\\nRelease url: {release_url}'\n  },\n  discogsApi: {\n    consumerKey: 'TJGtBNerXwCzYvFCQXSD',\n  }\n};\n","import { DiscogsCsv } from \"../app/discogs-csv.js\";\nimport { Release } from \"../../app/release.js\";\nimport config from \"../../config.js\";\nimport { replaceTokens } from \"../../modules/utils.js\";\n\n/**\n * @param {Release} release\n * @returns {DiscogsCsv}\n */\nexport function releaseToDiscogsCsv(release) {\n  return DiscogsCsv.fromRelease(release);\n}\n\nexport function getSearchDiscogsArtistUrl(artist) {\n  return replaceTokens(config.discogs_search_artist_url, {artist: artist});\n}\n\nexport function getSearchDiscogsReleaseUrl(artist, release) {\n  return replaceTokens(config.discogs_search_release_url, {artist: artist, release: release});\n}\n\n/**\n * @param {Release} release\n * @returns {String}\n */\nexport function generateSubmissionNotes(release) {\n  return replaceTokens(config.text.notes, {\n    extension_url: config.extension_url,\n    release_url: release.releaseItem.url\n  });\n}\n","import { isFunction } from \"./utils.js\";\n\nexport async function getCurrentTab(callback) {\n  let queryOptions = { active: true, currentWindow: true };\n\n  if (isFunction(callback)) {\n    chrome.tabs.query(queryOptions, callback);\n    return;\n  }\n\n  let [tab] = await chrome.tabs.query(queryOptions);\n  return tab;\n};\n\nexport function getExtensionManifest() {\n  const manifest = chrome.runtime.getManifest();\n  return manifest;\n}\n\nexport async function openTabs(urls, callback) {\n  const tabPromises = [];\n\n  for (const url of urls) {\n    const tabPromise = new Promise((resolve) => {\n      chrome.tabs.create({ url, active: false }, (tab) => {\n        if (callback) {\n          callback(tab);\n        }\n        resolve(tab);\n      });\n    });\n\n    tabPromises.push(tabPromise);\n  }\n\n  return Promise.all(tabPromises);\n}\n\nexport function getExtensionUrl(path) {\n  return chrome.runtime.getURL(path);\n}\n","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n\nfunction parse(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  let v;\n  const arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nexport default parse;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  const l = bytes.length / 4 + 2;\n  const N = Math.ceil(l / 16);\n  const M = new Array(N);\n\n  for (let i = 0; i < N; ++i) {\n    const arr = new Uint32Array(16);\n\n    for (let j = 0; j < 16; ++j) {\n      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n\n    M[i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (let i = 0; i < N; ++i) {\n    const W = new Uint32Array(80);\n\n    for (let t = 0; t < 16; ++t) {\n      W[t] = M[i][t];\n    }\n\n    for (let t = 16; t < 80; ++t) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n\n    for (let t = 0; t < 80; ++t) {\n      const s = Math.floor(t / 20);\n      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nconst v5 = v35('v5', 0x50, sha1);\nexport default v5;","import { unsafeStringify } from './stringify.js';\nimport parse from './parse.js';\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  const bytes = [];\n\n  for (let i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function v35(name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    var _namespace;\n\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = parse(namespace);\n    }\n\n    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    let bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (let i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return unsafeStringify(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","import { v5 as uuid5} from 'uuid';\nimport { Release } from '../app/release.js';\n\n/**\n * @param {String} url\n * @returns {String}\n */\nexport function generateKeyForUrl(url) {\n  const uuid = uuid5(url, uuid5.URL);\n  // console.log(`B2D: uuid5(${url}): `, uuid);\n  return uuid;\n}\n\n/**\n * @param {ReleaseItem} releaseItem\n * @return {String}\n */\nexport function generateKeyForReleaseItem(releaseItem) {\n  return generateKeyForUrl(releaseItem.url);\n}\n\n/**\n * @param {Release} release\n * @return {String}\n */\nexport function generateKeyForRelease(release) {\n  return generateKeyForReleaseItem(release.releaseItem);\n}\n\nexport function generateKeysFromUrls(urls) {\n  const keys = [];\n  urls.forEach(url => keys.push(generateKeyForUrl(url)));\n  return keys;\n}\n\nexport function generateKeyUrlMapFromUrls(urls) {\n  const keyUrlMap = {};\n\n  urls.forEach(url => {\n    const key = generateKeyForUrl(url);\n    keyUrlMap[key] = url;\n  });\n\n  return keyUrlMap;\n}\n","class TrackTime {\n  /**\n   * @type {Number}\n   */\n  #hours;\n\n  /**\n   * @type {Number}\n   */\n  #minutes;\n\n  /**\n   * @type {Number}\n   */\n  #seconds;\n\n  /**\n   * Constructs a Time object with hours, minutes, and seconds.\n   * @param {number} hours - The hours component of the time.\n   * @param {number} minutes - The minutes component of the time.\n   * @param {number} seconds - The seconds component of the time.\n   */\n  constructor(hours, minutes, seconds) {\n      this.#hours = hours;\n      this.#minutes = minutes;\n      this.#seconds = seconds;\n  }\n\n  get value() {\n    return this.toString();\n  }\n\n  get date() {\n    return this.toDate();\n  }\n\n  /**\n   * Returns a string representation of the duration in the format \"HH:MM:SS\".\n   * @returns {string} String representation of the duration.\n   */\n  toString() {\n    const formatter = new Intl.DateTimeFormat('en', {\n      hour12: false,\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n    });\n\n    return formatter.format(this.toDate());\n  }\n\n  toDate() {\n    const date = new Date(0);\n    date.setHours(this.#hours);\n    date.setMinutes(this.#minutes);\n    date.setSeconds(this.#seconds);\n\n    return date;\n  }\n\n  /**\n   * Parses a time string in the format HH:MM:SS and returns an object with hours, minutes, and seconds.\n   * Throws an error if the input string is not in the valid time format.\n   *\n   * @param {string} timeString - The time string to parse, expected in the format HH:MM:SS.\n   * @returns {TrackTime} A Time object containing the parsed hours, minutes, and seconds as numbers.\n   * @throws {Error} Throws an error if the input string is not in the valid time format HH:MM:SS.\n   */\n  static fromString(timeString) {\n    // Regular expression to match HH:MM:SS format\n    const timeFormat = /^([01]\\d|2[0-3]):([0-5]\\d):([0-5]\\d)$/;\n\n    if (!timeFormat.test(timeString)) {\n        throw new Error(\"Invalid time format. Please use HH:MM:SS.\");\n    }\n\n    const [hours, minutes, seconds] = timeString.split(':');\n\n    return new TrackTime(\n      parseInt(hours, 10),\n      parseInt(minutes, 10),\n      parseInt(seconds, 10)\n    );\n  }\n\n  /**\n   * Creates a Duration instance from a duration string.\n   * The duration string should be in the format \"XHYMZS\",\n   * where X is hours, Y is minutes, and Z is seconds.\n   * See: https://en.wikipedia.org/wiki/ISO_8601\n   * @param {string} duration\n   * @returns {TrackTime}\n   */\n  static fromDuration(duration) {\n    const regexHours = /(\\d+)H/;\n    const regexMinutes = /(\\d+)M/;\n    const regexSeconds = /(\\d+)S/;\n    const hours = (regexHours.exec(duration) || [])[1] || 0;\n    const minutes = (regexMinutes.exec(duration) || [])[1] || 0;\n    const seconds = (regexSeconds.exec(duration) || [])[1] || 0;\n\n    return new TrackTime(\n      parseInt(hours, 10),\n      parseInt(minutes, 10),\n      parseInt(seconds, 10)\n    );\n  }\n}\n\nexport default TrackTime;\n","import { generateSubmissionNotes } from '../discogs/modules/discogs.js';\nimport { getExtensionManifest } from '../modules/chrome.js';\nimport { generateKeyForUrl } from '../modules/key-generator.js';\nimport TrackTime from './trackTime.js';\n\nexport class ReleaseItem {\n  constructor(url, artist, title) {\n    this.url = url;\n    this.artist = artist;\n    this.title = title;\n    this.uuid = generateKeyForUrl(url);\n  }\n\n  static fromObject(obj) {\n    return new ReleaseItem(obj.url, obj.artist, obj.title);\n  }\n}\n\nexport class Release {\n  /**\n   * @type {ReleaseItem}\n   */\n  releaseItem;\n\n  /**\n   * @type {string}\n   */\n  label;\n\n  /**\n   * @type {Date}\n   */\n  published;\n\n  /**\n   * @type {Date}\n   */\n  modified;\n\n  /**\n   * @type {Array.<Track>}\n   */\n  tracks;\n\n  /**\n   * @type {Number}\n   */\n  tracksQty;\n\n  /**\n   * @type {string}\n   */\n  image;\n\n  /**\n   * @type {Array.<string>}\n   */\n  keywords;\n\n  /**\n   * @param {string} artist\n   * @param {string} title\n   * @param {string} label\n   * @param {Date} datePublished\n   * @param {Date} dateModified\n   * @param {Array.<Track>} tracks\n   * @param {string} url\n   * @param {string} image\n   * @param {Array.<string>} keywords\n   */\n  constructor(artist, title, label, datePublished, dateModified, tracks, url, image, keywords) {\n    this.releaseItem = new ReleaseItem(url, artist, title);\n    this.label = label;\n    this.published = datePublished;\n    this.modified = dateModified;\n    this.tracks = tracks;\n    this.tracksQty = tracks.length;\n    this.image = image;\n    this.keywords = keywords;\n  }\n\n  get artist() {\n    return this.releaseItem.artist;\n  }\n\n  get url() {\n    return this.releaseItem.url;\n  }\n\n  get title() {\n    return this.releaseItem.title;\n  }\n\n  toStorageObject() {\n    return {\n      uuid: this.releaseItem.uuid,\n      artist: this.releaseItem.artist,\n      title: this.releaseItem.title,\n      url: this.releaseItem.url,\n      label: this.label,\n      published: this.published.toISOString(),\n      modified: this.modified.toISOString(),\n      tracks: this.tracks.map(track => track.toStorageObject()),\n      image: this.image,\n      keywords: this.keywords\n    };\n  }\n\n  /**\n   * Create an instance of the Release class from the object.\n   * @param {Object} obj - A simple object.\n   * @returns {Release} An instance of the Release class.\n   */\n  static fromStorageObject(obj) {\n    if (!obj.url || !obj.tracks) {\n      throw new Error('Cannot create Release object from object', obj);\n    }\n\n    const tracks = obj.tracks.map(trackData => Track.fromStorageObject(trackData));\n\n    if (!obj.published && !obj.date) {\n      throw new Error(\"Missing published or date property\");\n    }\n\n    if (!obj.modified && !obj.date) {\n      throw new Error(\"Missing published or date property\");\n    }\n\n    return new Release(\n      obj.artist,\n      obj.title,\n      obj.label,\n      new Date(obj.published ?? obj.date),\n      new Date(obj.modified ?? obj.date),\n      tracks,\n      obj.url,\n      obj.image,\n      obj.keywords\n    );\n  }\n\n  /**\n   * Returns release metadata\n   * @param {Release} release\n   * @returns Object\n   */\n  toMetadata() {\n    const manifest = getExtensionManifest();\n    return {\n      version: manifest.version,\n      format: {\n        qty: this.tracksQty,\n        fileType: 'FLAC',\n        description: 'Album'\n      },\n      submissionNotes: generateSubmissionNotes(this)\n    };\n  }\n}\n\nexport class Track {\n  /**\n   * @type {String}\n   */\n  num;\n\n  /**\n   * @type {String}\n   */\n  title;\n\n  /**\n   * @type {TrackTime}\n   */\n  time;\n\n  /**\n   * @param {String} num\n   * @param {String} title\n   * @param {TrackTime} time\n   */\n  constructor(num, title, time) {\n    this.num = num;\n    this.title = title;\n    this.time = time;\n  }\n\n  toStorageObject() {\n    return {\n      num: this.num,\n      title: this.title,\n      time: this.time.value\n    };\n  }\n\n  /**\n   * Create an instance of the Track class from the object.\n   * @param {Object} obj - A simple object.\n   * @returns {Track} An instance of the Track class.\n   */\n  static fromStorageObject(obj) {\n    return new Track(\n      obj.num,\n      obj.title,\n      TrackTime.fromString(obj.time || obj.duration)\n    );\n  }\n}\n","import { safeFilename } from \"./utils.js\";\n\nexport function arrayToCsv(rows) {\n  return rows.map(e => e.join(\",\")).join(\"\\n\");\n}\n\nexport function objectsToCsv(objects) {\n  if (!objects || objects.length === 0) {\n    return ''; // Return an empty string if the array is empty or not provided\n  }\n\n  const headers = Object.keys(objects[0]);\n  const csvRows = [headers.join(',')];\n\n  for (const obj of objects) {\n    const values = headers.map(header => obj[header]);\n    csvRows.push(values.join(','));\n  }\n\n  return csvRows.join('\\n');\n}\n\nexport function downloadCsv(csv, csvFileName) {\n  const blob = new Blob([csv], { type: 'text/csv' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `${safeFilename(csvFileName)}.csv`;\n  a.click();\n  URL.revokeObjectURL(url);\n}\n","import { isArray, isObject, isString } from \"./utils.js\";\n\nexport function hasDataAttribute(element, attributeName) {\n  return element.hasAttribute(`data-${attributeName}`);\n}\n\nexport function setDataAttribute(element, attributeName, attributeValue = '') {\n  if (isObject(attributeName)) {\n    const obj = attributeName;\n    for (const key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        setDataAttribute(element, key, obj[key]);\n      }\n    }\n    return;\n  }\n  element.setAttribute(`data-${attributeName}`, attributeValue);\n}\n\nexport function getDataAttribute(element, attributeName, defaultValue = undefined) {\n  return hasDataAttribute(element, attributeName) ? element.getAttribute(`data-${attributeName}`) : defaultValue;\n}\n\nexport function show(...element) {\n  element.forEach(el => isArray(el) ? show(...el) : el.classList.remove('visually-hidden'));\n}\n\nexport function hide(...element) {\n  element.forEach(el => isArray(el) ? hide(...el) : el.classList.add('visually-hidden'));\n}\n\nexport function disable(...element) {\n  element.forEach(el => isArray(el) ? disable(...el) : (el.disabled = true));\n}\n\nexport function enable(...element) {\n  element.forEach(el => isArray(el) ? enable(...el) : (el.disabled = false));\n}\n\n/**\n * Triggers click event on the element\n * @param {Element} element\n */\nexport function click(element) {\n  var event = new MouseEvent(\"click\", {\n      bubbles: true,\n      cancelable: true,\n      view: window\n  });\n  element.dispatchEvent(event);\n  return element;\n}\n\n/**\n * Triggers input event on element\n * @param {Element} element\n */\nexport function input(element, value) {\n  if (isString(value)) {\n    // Trigger input event only when the value has changed\n    if (element.value !== value) {\n      element.value = value;\n      triggerInputEvent(element);\n    }\n\n    return element;\n  }\n\n  triggerInputEvent(element);\n  return element;\n}\n\nfunction triggerInputEvent(element) {\n  element.dispatchEvent(new Event('input'));\n  return element;\n}\n\n/**\n * @param {String} htmlString\n * @returns {Element}\n */\nexport function createElementFromHTML(htmlString) {\n  const tempDiv = document.createElement('div');\n  tempDiv.innerHTML = htmlString.trim();\n  return tempDiv.firstChild;\n}\n\nexport function createSelectListFromArray(arrayOfObjects, selectId) {\n  const selectElement = document.createElement('select');\n  selectElement.id = selectId; // Set the id for the select element\n\n  arrayOfObjects.forEach((obj) => {\n    const optionElement = document.createElement('option');\n    optionElement.value = obj.value;\n    optionElement.text = obj.text;\n    selectElement.appendChild(optionElement);\n  });\n\n  return selectElement;\n}\n\nexport function createDataListFromArray(arrayOfObjects, selectId) {\n  const selectElement = document.createElement('select');\n  selectElement.id = selectId; // Set the id for the select element\n\n  arrayOfObjects.forEach((obj) => {\n    const optionElement = document.createElement('option');\n    optionElement.value = obj.value;\n    optionElement.text = obj.text;\n    selectElement.appendChild(optionElement);\n  });\n\n  return selectElement;\n}\n\nexport function createDatalistFromArray(dataArray, datalistId) {\n  const datalist = document.createElement('datalist');\n  datalist.id = datalistId;\n\n  dataArray.forEach((optionText) => {\n    const option = document.createElement('option');\n    option.value = optionText;\n    datalist.appendChild(option);\n  });\n\n  return datalist;\n}\n\nexport function contentChangeWithPolling(element, callback, interval = 1000) {\n  let previousContent = element.textContent;\n\n  const poller = setInterval(() => {\n    const currentContent = element.textContent;\n    if (currentContent !== previousContent) {\n      callback(currentContent);\n      previousContent = currentContent;\n    }\n  }, interval);\n\n  // Optionally, you can return a function to stop the polling when needed\n  return function stopPolling() {\n    clearInterval(poller);\n  };\n}\n\nexport function selectElementWithContent(rootElement, querySelector, content) {\n  const elements = rootElement.querySelectorAll(querySelector);\n\n  for (const element of elements) {\n    if (element.textContent.includes(content)) {\n      return element;\n    }\n  }\n\n  return null;\n}\n\nexport function isElementDisplayNone(element) {\n  return window.getComputedStyle(element).display === 'none';\n}\n\nexport function isHtmlElement(element) {\n  return element instanceof HTMLElement;\n}\n\nexport function getCurrentUrl() {\n  return window.location.href;\n}\n","import { Release } from \"../app/release.js\";\nimport { isValidBandcampURL } from \"../bandcamp/modules/html.js\";\nimport { generateKeyForRelease, generateKeyForUrl, generateKeyUrlMapFromUrls, generateKeysFromUrls } from \"./key-generator.js\";\nimport { isArray, isFunction, isObject } from \"./utils.js\";\n\nconst storage = chrome.storage.local;\n\nexport function logStorage() {\n  console.log('B2D: Storage data');\n  storage.get(null, (data) => console.log(data));\n}\n\nexport function findAllReleases(onFind) {\n  storage.get(null, (data) => {\n    const releases = [];\n\n    for (const key in data) {\n      if (!data.hasOwnProperty(key) && !isObject(data[key])) {\n        continue;\n      }\n\n      try {\n        releases.push(Release.fromStorageObject(data[key]));\n      } catch (error) {\n        continue;\n      }\n    }\n\n    if (isFunction(onFind)) onFind(releases);\n  });\n}\n\nexport function findReleaseByUrl(url, onFind, onMissing) {\n  const key = generateKeyForUrl(url);\n  storage.get([key], (result) => {\n    if (isObject(result[key])) {\n      try {\n        const release = Release.fromStorageObject(result[key]);\n        if (isFunction(onFind)) onFind(release);\n      } catch (error) {\n        console.log(\"B2D: Broken storage data for release\", result[key]);\n        clearStorageByKey(key);\n      }\n    } else {\n      console.log(\"B2D: Release data doesn't exists\", key);\n      if (isFunction(onMissing)) onMissing(key);\n    }\n  });\n\n}\n\nexport function findReleasesByUrls(urls, onFind) {\n  const keys = generateKeysFromUrls(urls);\n  storage.get(keys, result => {\n    let releases = Object\n      .values(result)\n      .map(function(obj) {\n        try {\n          return Release.fromStorageObject(obj);\n        } catch (error) {\n          console.log(\"B2D: Broken storage object. \" + JSON.stringify(error), obj);\n          return null;\n        }\n      })\n      .filter(obj => obj instanceof Release);\n    if (isFunction(onFind)) onFind(releases);\n  });\n}\n\nexport function findMissingUrls(urls, onFind) {\n  const keyUrlMap = generateKeyUrlMapFromUrls(urls);\n  const keys = Object.keys(keyUrlMap);\n  storage.get(keys, result => {\n    const foundKeys = Object.keys(result);\n    const missingKeys = keys.filter(key => !foundKeys.includes(key));\n    const missingUrls = missingKeys.map(key => keyUrlMap[key]);\n    if (isFunction(onFind)) onFind(missingUrls);\n  });\n}\n\n/**\n * @param {Release} release\n */\nexport function saveRelease(release) {\n  const key = generateKeyForRelease(release);\n  storage.set({ [key]: release.toStorageObject() }, () => {\n    console.log(\"B2D: Release data was saved in the local storage\");\n  });\n}\n\n/**\n * @param {String} key\n * @param {Array} categoryValues\n */\nexport function addReleaseHistory(key, categoryValues) {\n  storage.get([key], (data) => {\n    let releaseData = data[key] || null;\n    if (releaseData === null) return;\n    let history = releaseData.history || {};\n\n    const date = new Date();\n    const dateStr = date.toISOString();\n\n    for (let category in categoryValues) {\n      if (!categoryValues.hasOwnProperty(category)) continue;\n\n      let historyCategory = history[category] || [];\n      if (!isArray(historyCategory)) continue;\n\n      const historyValue = {\n        date: dateStr,\n        value: categoryValues[category]\n      };\n\n      addUniqueValueObjectToArray(historyCategory, historyValue);\n      history[category] = historyCategory;\n    }\n\n    releaseData.history = history;\n\n    storage.set({ [key]: releaseData }, () => {\n      console.log(\"B2D: Release history for categories was saved successfully\", categoryValues);\n    });\n  });\n}\n\nfunction addUniqueValueObjectToArray(arr, obj) {\n  if (arr.length === 0 || arr[arr.length - 1].value !== obj.value) {\n      arr.push(obj);\n  }\n}\n\nexport function clearStorage() {\n  storage.clear();\n}\n\nexport function clearStorageByKey(key, onDone) {\n  isArray(key)\n    ? key.forEach(k => clearStorageByKey(k, onDone))\n    : storage.remove(key, () => {\n      if (chrome.runtime.lastError) {\n        console.error(`Error clearing local storage item with key \"${key}\": ${chrome.runtime.lastError}`);\n      }\n\n      if (isFunction(onDone)) onDone();\n    });\n}\n\nexport function getStorageSize(callable) {\n  storage.getBytesInUse(null, callable);\n}\n","import { Release, ReleaseItem } from \"../app/release.js\";\nimport { getSearchDiscogsReleaseUrl } from \"../discogs/modules/discogs.js\";\nimport { disable, enable, getDataAttribute, hasDataAttribute, setDataAttribute } from \"../modules/html.js\";\nimport { generateKeyForReleaseItem } from \"../modules/key-generator.js\";\nimport { convertToAlias, isArray, isObject, isString } from \"../modules/utils.js\";\n\nexport function createBootstrapCheckbox(id, value, labelText, checked) {\n  // Create the checkbox input element\n  const checkboxInput = document.createElement(\"input\");\n  checkboxInput.classList.add(\"form-check-input\");\n  checkboxInput.type = \"checkbox\";\n  checkboxInput.id = id;\n  checkboxInput.value = value;\n  checkboxInput.checked = checked;\n\n  // Create the label element\n  const label = document.createElement(\"label\");\n  label.classList.add(\"form-check-label\");\n  label.htmlFor = id;\n  label.innerHTML = labelText;\n\n  // Create the div container for the checkbox and label\n  const container = document.createElement(\"div\");\n  container.classList.add(\"form-check\");\n  container.appendChild(checkboxInput);\n  container.appendChild(label);\n\n  return container;\n}\n\n/**\n * Converts a JavaScript object to an HTML element representing a table.\n * @param {Object} data - The JavaScript object to convert.\n * @returns {Node} - The HTML element representing the converted table.\n */\nexport function objectToHtmlElement(data) {\n  if (!isObject(data) && !isArray(data)) {\n    return document.createTextNode(data);\n  }\n\n  const table = document.createElement(\"table\");\n  table.classList.add(\"table\", \"table-sm\", \"table-striped\", \"table-bordered\");\n\n  for (const [key, value] of Object.entries(data)) {\n    const row = document.createElement(\"tr\");\n    const keyCell = document.createElement(\"th\");\n    const valueCell = document.createElement(\"td\");\n\n    keyCell.classList.add(\"w-25\");\n    valueCell.classList.add(\"w-auto\");\n\n    keyCell.textContent = key;\n\n    if (isObject(value)) {\n      valueCell.appendChild(objectToHtmlElement(value));\n    } else if (isArray(value)) {\n      valueCell.innerHTML = value\n        .map(item => (isString(item) ? item : objectToHtmlElement(item).outerHTML))\n        .join(\", \");\n    } else {\n      valueCell.innerHTML = isString(value)\n        ? value.replace(/[\\r\\n]+/g, \"<br/>\")\n        : value;\n    }\n\n    row.appendChild(keyCell);\n    row.appendChild(valueCell);\n    table.appendChild(row);\n  }\n\n  return table;\n}\n\n/**\n * Converts an object into a nested HTML <details> element with key-value pairs.\n *\n * @param {Object} obj - The input object to be converted into a details element.\n * @param {string} [title=''] - An optional title for the top-level <summary> element.\n * @returns {HTMLElement} The generated <details> element representing the object's structure.\n */\nexport function objectToDetailsElement(obj, title = '') {\n  const detailsElement = document.createElement('details');\n  const summaryElement = document.createElement('summary');\n  summaryElement.textContent = title;\n  detailsElement.appendChild(summaryElement);\n\n  Object.entries(obj).forEach(([key, value]) => {\n    if ((isObject(value) || isArray(value)) && value !== null) {\n      const nestedDetails = objectToDetailsElement(value, key);\n      detailsElement.appendChild(nestedDetails);\n    } else {\n      const keyValueDetails = createKeyValueDetails(key, value);\n      detailsElement.appendChild(keyValueDetails);\n    }\n  });\n\n  return detailsElement;\n}\n\n/**\n * Creates a <details> element with a key-value pair.\n *\n * @param {string} key - The key (property name) of the object property.\n * @param {*} value - The value associated with the key.\n * @returns {HTMLElement} The generated <details> element representing the key-value pair.\n */\nexport function createKeyValueDetails(key, value) {\n  const keyValueDetails = document.createElement('details');\n  const summaryElement = document.createElement('summary');\n  summaryElement.textContent = key;\n  keyValueDetails.appendChild(summaryElement);\n\n  const valueElement = document.createElement('div');\n\n  if (value instanceof HTMLElement) {\n    valueElement.appendChild(value);\n  } else {\n    valueElement.textContent = value instanceof Date ? value.toISOString() : value;\n  }\n\n  keyValueDetails.appendChild(valueElement);\n\n  return keyValueDetails;\n}\n\n/**\n * @param {Element} button\n * @param {Array<Element>} checkboxes\n */\nexport function updateButtonState(button, checkboxes) {\n  const anyCheckboxChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);\n  button.disabled = !anyCheckboxChecked;\n}\n\n/**\n * @param {Array<ReleaseItem>|Array<Release>} releases\n * @return {Array}\n */\nfunction transformReleaseItemsToReleaseListData(releases) {\n  const data = [];\n\n  releases.forEach(item => {\n    const release = item instanceof Release ? item.releaseItem : item;\n    const viewLink = getIconLinkHtml(release.url, 'box-arrow-up-right', 'link-bandcamp-url');\n    const searchLink = getIconLinkHtml(getSearchDiscogsReleaseUrl(release.artist, release.title), 'search', 'link-discogs-search');\n    data.push({\n      title: `${release.artist} - ${release.title} ${viewLink} ${searchLink}`,\n      value: generateKeyForReleaseItem(release),\n      id: convertToAlias(release.title),\n      dataAtts: {\n        title: `${release.artist} - ${release.title}`\n      }\n    });\n  });\n\n  return data;\n}\n\n/**\n * @param {ReleasesList} releasesList\n * @param {Array<ReleaseItem>|Array<Release>} releases\n */\nexport function populateReleasesList(releasesList, releases) {\n  releasesList.populateData(\n    transformReleaseItemsToReleaseListData(releases)\n  );\n}\n\nexport function getIconLinkHtml(url, icon, className) {\n  const releaseLink = document.createElement(\"a\");\n  releaseLink.classList.add(className);\n  releaseLink.href = url;\n  releaseLink.target = '_blank';\n  releaseLink.innerHTML = `<b2d-icon name=\"${icon}\"></b2d-icon>`;\n  return releaseLink.outerHTML;\n}\n\nexport function setBackgroundImage(element, imageUrl) {\n  if (!element instanceof HTMLElement) return;\n  element.style.backgroundImage = `url(${imageUrl})`;\n}\n\nexport function setButtonInLoadingState(button) {\n  disable(button);\n  setDataAttribute(button, 'original-content', button.innerHTML);\n  button.innerHTML = `\n  <span class=\"spinner-border spinner-border-sm\" aria-hidden=\"true\"></span>\n  <span class=\"visually-hidden\" role=\"status\">Loading...</span>\n`;\n  return button;\n}\n\nexport function removeButtonLoadingState(button) {\n  enable(button);\n  if (hasDataAttribute(button, 'original-content')) {\n    button.innerHTML = getDataAttribute(button, 'original-content');\n  }\n  return button;\n}\n","import { DiscogsCsv } from \"../../discogs/app/discogs-csv.js\";\nimport { downloadCsv, objectsToCsv } from \"../../modules/csv.js\";\nimport { createElementFromHTML, hasDataAttribute, setDataAttribute } from \"../../modules/html.js\";\nimport { clearStorage, clearStorageByKey, findAllReleases, findReleasesByUrls, logStorage } from \"../../modules/storage.js\";\nimport { populateReleasesList, removeButtonLoadingState, setButtonInLoadingState } from \"../helpers.js\";\n\n/**\n * @param {Element} btnDownloadCsv\n */\nexport function setupHistoryTab(tab, btnDownloadCsv) {\n  const releasesList = document.querySelector('#historyReleasesList');\n\n  if (!hasDataAttribute(tab, 'buttons-initialized')) {\n    setupReleasesList(tab, releasesList, btnDownloadCsv);\n    setDataAttribute(tab, 'buttons-initialized');\n  }\n\n  updateReleasesListData(releasesList);\n}\n\nfunction updateReleasesListData(releasesList) {\n  findAllReleases((releases) => {\n    populateReleasesList(releasesList, releases);\n  });\n}\n\n/**\n * @param {Element} tab\n * @param {ReleasesList} releasesList\n * @param {Element} btnDownloadCsv\n */\nfunction setupReleasesList(tab, releasesList, btnDownloadCsv) {\n  const btnClearSelected = createElementFromHTML(`\n<button id=\"historyDataClearSelected\" type=\"button\" class=\"btn btn-danger\" data-status-update title=\"Clear selected history\">\n  <b2d-icon name=\"database-dash\"></b2d-icon>\n</button>`);\n  const btnClearAll = createElementFromHTML(`\n<button id=\"historyDataClear\" type=\"button\" class=\"btn btn-dark\" title=\"Remove all items from the history\" data-bs-toggle=\"modal\" data-bs-target=\"#historyTabDeleteAllModal\">\n  <b2d-icon name=\"database-x\"></b2d-icon>\n</button>`);\n\n  const downloadCsvFile = (event) => {\n    const button = event.target;\n    setButtonInLoadingState(button);\n\n    const bcLinks = releasesList.querySelectorAll('.release-item.table-active .link-bandcamp-url');\n    const checkedUrls = Array.from(bcLinks).map(link => link.getAttribute('href'));\n\n    findReleasesByUrls(checkedUrls, releases => {\n      const firstRelease = releases[0];\n      const csvObjects = releases.map(release => DiscogsCsv.fromRelease(release).toCsvObject());\n      const csv = objectsToCsv(csvObjects);\n      downloadCsv(csv, `discogs-selected-releases-${firstRelease.artist}`);\n      removeButtonLoadingState(button);\n    });\n  }\n\n  btnDownloadCsv.addEventListener('click', downloadCsvFile);\n  releasesList.addStateButton(btnDownloadCsv);\n\n  btnClearSelected.addEventListener('click', () => {\n    const selectedValues = releasesList.getSelectedValues();\n    clearStorageByKey(selectedValues, () => {\n      updateReleasesListData(releasesList);\n    });\n  });\n\n  tab.querySelector('#historyTabDeleteAllModal_btnYes').addEventListener('click', () => {\n    clearStorage();\n    updateReleasesListData(releasesList);\n  });\n\n  releasesList.appendButton(btnClearSelected, btnClearAll);\n  releasesList.addStatusElement(\n    document.getElementById('selectedStatusInfo'),\n    document.getElementById('viewedStatusInfo')\n  );\n}\n","import { Release } from \"../../app/release.js\";\nimport { DiscogsCsv } from \"../../discogs/app/discogs-csv.js\";\nimport { downloadCsv, objectsToCsv } from \"../../modules/csv.js\";\nimport { isEmptyArray } from \"../../modules/utils.js\";\nimport { disable, enable } from \"../../modules/html.js\";\n\n/**\n * @param {Element} button\n * @param {Array<Release>} releases\n */\nexport function setupBtnToDownloadReleasesAsCsv(button, releases) {\n  if (isEmptyArray(releases)) {\n    disable(button);\n    return;\n  }\n\n  enable(button);\n  button.addEventListener('click', () => downloadReleasesCsv(releases));\n}\n\n/**\n * @param {Array<Release>} releases\n */\nexport function downloadReleasesCsv(releases) {\n  if (isEmptyArray(releases)) {\n    return;\n  }\n\n  const firstRelease = releases[0];\n  const csvObjects = releases.map(release => DiscogsCsv.fromRelease(release).toCsvObject());\n  const csv = objectsToCsv(csvObjects);\n\n  const filename = releases.length > 1 ? `discogs-selected-releases-${firstRelease.artist}` : `discogs-releases-${firstRelease.artist}-${firstRelease.title}`;\n\n  downloadCsv(csv, filename);\n}\n","import { ReleaseItem } from \"../../app/release.js\";\nimport { getCurrentTab, openTabs } from \"../../modules/chrome.js\";\nimport { input } from \"../../modules/html.js\";\nimport { findReleasesByUrls } from \"../../modules/storage.js\";\nimport { populateReleasesList, removeButtonLoadingState, setBackgroundImage, setButtonInLoadingState } from \"../helpers.js\";\nimport { downloadReleasesCsv } from \"./download_tab.js\";\n\nexport function setupReleasesTab(tab, releasesData, bgImageSrc, searchValue, btnNavDownload) {\n  setBackgroundImage(document.querySelector('.bg-image'), bgImageSrc);\n  const releasesList = tab.querySelector('#releasesTabLIst');\n  const downloadCsvFile = async (event) => {\n    const button = event.target;\n    setButtonInLoadingState(button);\n\n    const bcLinks = releasesList.querySelectorAll('.release-item.table-active .link-bandcamp-url');\n    const checkedUrls = Array.from(bcLinks).map(link => link.getAttribute('href'));\n\n    openTabs(checkedUrls, (tab) => {\n      chrome.scripting.executeScript({\n        target: { tabId: tab.id },\n        func: waitForBandcampData\n      }).then(() => {});\n    }).then(() => {\n      setTimeout(() => {\n        // Read data from the storage\n        findReleasesByUrls(checkedUrls, releases => {\n          downloadReleasesCsv(releases);\n          removeButtonLoadingState(button);\n        });\n      }, 3000);\n    });\n  };\n\n  btnNavDownload.addEventListener('click', downloadCsvFile);\n  releasesList\n    .addStateButton(btnNavDownload)\n    .addStatusElement(\n      document.getElementById('selectedStatusInfo'),\n      document.getElementById('viewedStatusInfo')\n    );\n\n  const releaseItems = [];\n  releasesData.forEach(obj => releaseItems.push(ReleaseItem.fromObject(obj)));\n  populateReleasesList(releasesList, releaseItems);\n\n  let activeTab;\n  releasesList.searchInput.addEventListener('input', () => {\n    const selectedValue = releasesList.searchInput.value;\n\n    if (!activeTab) {\n      getCurrentTab().then((tab) => {\n        activeTab = tab;\n        sendSearchMessageToTab(activeTab, selectedValue);\n      });\n    } else {\n      sendSearchMessageToTab(activeTab, selectedValue);\n    }\n  });\n\n  input(releasesList.searchInput, searchValue);\n\n  function sendSearchMessageToTab(tab, search) {\n    chrome.tabs.sendMessage(tab.id, {\n      type: 'releases-list-search',\n      search: search\n    });\n  }\n}\n\nfunction waitForBandcampData() {\n  setTimeout(() => window.close(), 1000);\n}\n","/**\n * @param {HTMLElement} element\n * @param {string} content\n */\nexport const initClipboard = (element, content) => {\n  element.addEventListener('click', () => {\n    const icon = element.querySelector('b2d-icon');\n    copyToClipboard(content ?? element.getAttribute('data-content')).then(() => {\n      const initIconName = icon.getAttribute('name');\n      icon.setIcon('clipboard2-check-fill');\n      setTimeout(() => {\n        icon.setIcon(initIconName);\n      }, 3000)\n    });\n  });\n};\n\n/**\n * @param {string} str\n * @returns {Promise}\n */\nexport const copyToClipboard = str => {\n  if (navigator && navigator.clipboard && navigator.clipboard.writeText)\n    return navigator.clipboard.writeText(str);\n  return Promise.reject('The Clipboard API is not available.');\n};\n","import { Release } from \"../../app/release.js\";\nimport { getDiscogsDateValue } from \"../../discogs/app/utils.js\";\nimport { getSearchDiscogsReleaseUrl } from \"../../discogs/modules/discogs.js\";\nimport { capitalizeEachWord, removeLeadingZeroOrColon } from \"../../modules/utils.js\";\nimport { initClipboard } from \"../../utils/clipboard.js\";\nimport { setBackgroundImage } from \"../helpers.js\";\nimport { setupBtnToDownloadReleasesAsCsv } from \"./download_tab.js\";\n\n/**\n * @param {Element} tab\n * @param {Release} release\n * @param {Element} btnDownloadRelease\n * @param {Element} btnDiscogsSearch\n */\nexport function setupReleaseTab(tab, release, btnDownloadRelease, btnDiscogsSearch) {\n  outputRelease(tab, release);\n  btnDiscogsSearch.href = getSearchDiscogsReleaseUrl(release.releaseItem.artist, release.releaseItem.title);\n  setupBtnToDownloadReleasesAsCsv(btnDownloadRelease, [release]);\n}\n\n/**\n * @param {Element} tab\n * @param {Release} release\n */\nfunction outputRelease(tab, release) {\n  const releaseArtist = tab.querySelector('#release-artist');\n  const releaseTitle = tab.querySelector('#release-title');\n  const releaseDate = tab.querySelector('#release-year');\n  const releaseContent = tab.querySelector('.release-content');\n  const releaseTracks = tab.querySelector('#release-tracks');\n\n  setBackgroundImage(document.querySelector('.bg-image'), release.image);\n  releaseArtist.innerHTML = release.releaseItem.artist;\n  releaseTitle.innerHTML = release.releaseItem.title;\n  releaseDate.innerHTML = release.published.getFullYear();\n\n  let countArtistLines = countLinesInHtmlElement(releaseArtist);\n  let countTitleLines = countLinesInHtmlElement(releaseTitle);\n\n  releaseArtist.classList.toggle('display-6', countArtistLines >= 3 && countArtistLines <= 5);\n  tab.classList.add('lines-a' + countArtistLines + '-t' + countTitleLines);\n\n  const tracks = release.tracks\n    .map(track => `${track.num}. ${capitalizeEachWord(track.title)} (${removeLeadingZeroOrColon(track.time.value)})`)\n    .join(\"<br>\");\n\n  releaseTracks.innerHTML = tracks;\n\n  const formatter = new Intl.DateTimeFormat('en-US', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n  });\n  releaseContent.querySelectorAll('.js-releasePublishedDate').forEach(el => {\n    el.innerHTML = formatter.format(release.published) + el.innerHTML;\n    el.title = release.published.toLocaleString();\n    initClipboard(el.querySelector('.action-copy'), getDiscogsDateValue(release.published));\n  });\n  releaseContent.querySelectorAll('.js-releaseModifiedDate').forEach(el => {\n    el.innerHTML = formatter.format(release.modified) + el.innerHTML;\n    el.title = release.modified.toLocaleString();\n    initClipboard(el.querySelector('.action-copy'), getDiscogsDateValue(release.modified));\n  });\n}\n\nfunction countLinesInHtmlElement(el) {\n  let divHeight = el.offsetHeight\n  let lineHeight = parseInt(getComputedStyle(el).lineHeight);\n  return Math.round(divHeight / lineHeight);\n}\n","import { Release } from \"../../app/release.js\";\nimport { releaseToDiscogsCsv } from \"../../discogs/modules/discogs.js\";\nimport { objectToHtmlElement } from \"../helpers.js\";\n\nexport function setupCsvDataTab(release, btnCsvData) {\n\n  btnCsvData.addEventListener('click', () => {\n    const csvDataTabPane = document.getElementById('csvData');\n    csvDataTabPane.innerHTML = '';\n\n    if (release instanceof Release) {\n      const discogsCsv = releaseToDiscogsCsv(release);\n      appendObjectDataAsTable('Discogs CSV data', discogsCsv.toCsvObject(), csvDataTabPane);\n    }\n  });\n\n}\n\nfunction appendObjectDataAsTable(headline, obj, el) {\n  const headlineEl = document.createElement('h2');\n  headlineEl.classList.add('display-6');\n  headlineEl.innerText = headline;\n  el.appendChild(headlineEl);\n  el.appendChild(objectToHtmlElement(obj));\n}\n","import { Release } from \"../app/release.js\";\nimport { releaseToDiscogsCsv } from \"../discogs/modules/discogs.js\";\nimport { logStorage } from \"../modules/storage.js\";\n\nconst consoleCommand = document.querySelector('console-command');\n\nexport function setupConsole() {\n  consoleCommand.addCommand('log.storage', () => { logStorage();});\n}\n\n/**\n * @param {Release} release\n */\nexport function setupConsoleRelease(release, keywordsMapping) {\n  consoleCommand.addCommand('log.release', () => {\n    console.log(release);\n  });\n\n  consoleCommand.addCommand('log.keywordsMapping', () => {\n    console.log(keywordsMapping);\n  });\n\n  const discogsCsv = releaseToDiscogsCsv(release);\n  consoleCommand.addCommand('log.discogsCsvNotes', () => {\n    console.log(discogsCsv.notes);\n  });\n}\n","import { Release } from \"../app/release.js\";\nimport { getCurrentTab, getExtensionManifest } from \"../modules/chrome.js\";\nimport { loadDiscogsGenres } from \"../discogs/modules/genres.js\";\nimport { loadKeywordMapping } from \"../bandcamp/modules/mapping.js\";\nimport config from \"../config.js\";\nimport { setupHistoryTab } from \"./tabs/history_tab.js\";\nimport { disable, enable, hide, show, click } from \"../modules/html.js\";\nimport { setupReleasesTab } from \"./tabs/releases_tab.js\";\nimport { setupReleaseTab } from \"./tabs/release_tab.js\";\nimport { setupCsvDataTab } from \"./tabs/csv_data_tab.js\";\nimport { getStorageSize } from \"../modules/storage.js\";\nimport { bytesToSize } from \"../modules/utils.js\";\nimport { setupConsole, setupConsoleRelease } from \"./console.js\";\n\nconst btnDashboardTab = document.getElementById(\"dashboard-tab\");\nconst btnReleaseTab = document.getElementById(\"release-tab\");\nconst btnReleasesTab = document.getElementById(\"releases-tab\");\nconst btnCsvDataTab = document.getElementById('csvData-tab');\nconst btnHistoryTab = document.getElementById('history-tab');\nconst btnDownloadRelease = document.getElementById('downloadRelease');\nconst btnDownloadReleases = document.getElementById('downloadReleases');\nconst btnDownloadStorage = document.getElementById('downloadHistory');\nconst btnDiscogsSearchArtist = document.getElementById('discogsSearchArtist');\nconst tabReleases = document.getElementById('releases');\n\nasync function loadRelease() {\n  getCurrentTab().then((tab) => {\n    chrome.tabs.sendMessage(tab.id, { type: 'getBandcampData' }, (response) => {\n      if (response === null || typeof response === 'undefined' || Object.keys(response).length === 0 || typeof response.data === 'undefined') {\n        showBandcampDataNotFoundWarning();\n        return;\n      }\n\n      processBandcampResponse(response);\n    });\n  });\n}\n\nfunction showBandcampDataNotFoundWarning() {\n  disable(btnReleaseTab, btnCsvDataTab);\n  hide(btnReleasesTab);\n  show(btnDownloadReleases);\n  click(btnDashboardTab);\n\n  const warningBandcampDataNotFound = document.getElementById('b2d-warning-bandcamp-data-not-found');\n  show(warningBandcampDataNotFound);\n}\n\nfunction processBandcampResponse(response) {\n  const isRelease = response.type === 'release';\n  const isList = response.type === 'list';\n\n  if (!isRelease && !isList) {\n    // todo: Show error?\n    return;\n  }\n\n  loadDiscogsGenres(config.genres_url).then(genres => {\n    loadKeywordMapping(config.keyword_mapping_url).then(keywordsMapping => {\n      if (isRelease) {\n        processBandcampReleaseData(response.data, keywordsMapping);\n      } else {\n        processBandcampReleasesData(response);\n      }\n    })\n  });\n}\n\nfunction processBandcampReleaseData(data, keywordsMapping) {\n  hide(btnReleasesTab);\n  show(btnReleaseTab);\n  click(btnReleaseTab);\n\n  try {\n    const release = Release.fromStorageObject(data);\n    setupConsoleRelease(release, keywordsMapping);\n    setupReleaseTab(\n      document.getElementById('release'),\n      release,\n      btnDownloadRelease,\n      btnDiscogsSearchArtist\n    );\n    setupCsvDataTab(release, btnCsvDataTab);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction processBandcampReleasesData(response) {\n  hide(btnReleaseTab);\n  show(btnReleasesTab);\n  click(btnReleasesTab);\n\n  setupReleasesTab(\n    tabReleases,\n    response.data,\n    response.popup.imageSrc,\n    response.popup.search,\n    btnDownloadReleases\n  );\n}\n\nfunction replaceVersion(document) {\n  const manifest = getExtensionManifest();\n\n  // Set extension version\n  document.querySelectorAll('.version').forEach(el => {\n    el.textContent = manifest.version;\n  });\n}\n\nfunction setupNavigation() {\n  btnReleaseTab.addEventListener('click', () => {\n    hide(btnDownloadReleases, btnDownloadStorage);\n    show(btnDownloadRelease);\n    enable(btnCsvDataTab);\n  });\n  btnReleasesTab.addEventListener('click', () => {\n    hide(btnDownloadRelease, btnDownloadStorage);\n    show(btnDownloadReleases);\n    disable(btnCsvDataTab);\n\n    const releasesList = tabReleases.querySelector('releases-list');\n    releasesList.refreshStatus();\n  });\n  btnHistoryTab.addEventListener('click', () => {\n    hide(btnDownloadRelease, btnDownloadReleases);\n    show(btnDownloadStorage);\n    setupHistoryTab(\n      document.getElementById('history'),\n      btnDownloadStorage\n    );\n  });\n}\n\nfunction main() {\n  setupConsole();\n  setupNavigation();\n  replaceVersion(document);\n  loadRelease();\n  checkStorageSize();\n  onExternalContentLoaded((e) => {\n    replaceVersion(e.target);\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', main);\n\nfunction checkStorageSize() {\n  getStorageSize(size => {\n    document.querySelectorAll('.storage-size').forEach(el => {\n      el.textContent = bytesToSize(size);\n      el.setAttribute('title', `Storage size (${size} bytes)`)\n    });\n  });\n}\n\n/**\n * Run some specific logic for external content\n */\nfunction onExternalContentLoaded(fn) {\n  const externalContentElements = document.querySelectorAll('external-content');\n  externalContentElements.forEach(el => {\n    el.addEventListener('externalContentLoaded', fn);\n  });\n}\n"],"names":["transliterationMap","capitalizeEachWord","str","split","map","word","charAt","toUpperCase","slice","join","isString","value","Object","prototype","toString","call","Array","isArray","isEmptyArray","length","arrayToFlat","arr","concat","arrayUnique","Set","template","replacements","key","hasOwnProperty","replace","removeLeadingZeroOrColon","genres","mapping","getMapping","obj","isEmptyObject","keywordMapping","Style","createMapping","constructor","style","this","_genre","genre","element","prop","includes","getPropertyByElement","keywordToDiscogsGenre","keyword","toLowerCase","keywordMapData","keywordsToDiscogsGenres","keywordToDiscogsStyles","keywordsToDiscogsStyles","keywords","getDiscogsDateValue","date","toISOString","DiscogsCsv","artist","title","label","catno","format","styles","tracks","notes","images","fromRelease","release","releaseItem","JSON","stringify","toMetadata","published","image","addGenre","push","addStyle","addTrack","track","getGenre","filter","getStyle","getDate","toCsvObject","time","genres_url","keyword_mapping_url","about_url","extension_url","discogs_search_artist_url","discogs_search_release_url","text","discogsApi","consumerKey","releaseToDiscogsCsv","getSearchDiscogsReleaseUrl","async","getCurrentTab","callback","queryOptions","active","currentWindow","chrome","tabs","query","tab","getExtensionManifest","runtime","getManifest","byteToHex","i","uuid","test","TypeError","v","Uint8Array","parseInt","f","s","x","y","z","ROTL","n","name","version","hashfunc","generateUUID","namespace","buf","offset","_namespace","unescape","encodeURIComponent","bytes","charCodeAt","stringToBytes","set","K","H","msg","l","N","Math","ceil","M","Uint32Array","j","pow","floor","W","t","a","b","c","d","e","T","unsafeStringify","err","DNS","URL","v35","url","TrackTime","hours","minutes","seconds","toDate","Intl","DateTimeFormat","hour12","hour","minute","second","Date","setHours","setMinutes","setSeconds","fromString","timeString","Error","fromDuration","duration","exec","ReleaseItem","fromObject","modified","tracksQty","datePublished","dateModified","toStorageObject","fromStorageObject","trackData","Track","qty","fileType","description","submissionNotes","release_url","num","objectsToCsv","objects","headers","keys","csvRows","values","header","downloadCsv","csv","csvFileName","blob","Blob","type","createObjectURL","document","createElement","href","download","from","char","click","revokeObjectURL","hasDataAttribute","attributeName","hasAttribute","setDataAttribute","attributeValue","setAttribute","show","forEach","el","classList","remove","hide","add","disable","disabled","enable","event","MouseEvent","bubbles","cancelable","view","window","dispatchEvent","triggerInputEvent","Event","createElementFromHTML","htmlString","tempDiv","innerHTML","trim","firstChild","storage","local","findReleasesByUrls","urls","onFind","generateKeysFromUrls","get","result","releases","error","console","log","clearStorageByKey","onDone","k","lastError","objectToHtmlElement","data","createTextNode","table","entries","row","keyCell","valueCell","textContent","appendChild","item","outerHTML","populateReleasesList","releasesList","populateData","viewLink","getIconLinkHtml","searchLink","id","dataAtts","transformReleaseItemsToReleaseListData","icon","className","releaseLink","target","setBackgroundImage","imageUrl","HTMLElement","backgroundImage","setButtonInLoadingState","button","removeButtonLoadingState","getAttribute","defaultValue","setupHistoryTab","btnDownloadCsv","querySelector","btnClearSelected","btnClearAll","addEventListener","bcLinks","querySelectorAll","link","firstRelease","addStateButton","getSelectedValues","updateReleasesListData","clear","appendButton","addStatusElement","getElementById","setupReleasesList","downloadReleasesCsv","waitForBandcampData","setTimeout","close","initClipboard","content","copyToClipboard","then","initIconName","setIcon","navigator","clipboard","writeText","Promise","reject","countLinesInHtmlElement","divHeight","offsetHeight","lineHeight","getComputedStyle","round","setupCsvDataTab","btnCsvData","csvDataTabPane","headline","headlineEl","innerText","appendObjectDataAsTable","consoleCommand","btnDashboardTab","btnReleaseTab","btnReleasesTab","btnCsvDataTab","btnHistoryTab","btnDownloadRelease","btnDownloadReleases","btnDownloadStorage","btnDiscogsSearchArtist","tabReleases","loadRelease","sendMessage","response","isRelease","isList","fetch","json","catch","reason","loadDiscogsGenres","loadKeywordMapping","keywordsMapping","addCommand","discogsCsv","setupConsoleRelease","btnDiscogsSearch","releaseArtist","releaseTitle","releaseDate","releaseContent","releaseTracks","getFullYear","countArtistLines","countTitleLines","toggle","formatter","year","month","day","toLocaleString","outputRelease","setupReleaseTab","processBandcampReleaseData","releasesData","bgImageSrc","searchValue","btnNavDownload","checkedUrls","tabPromises","tabPromise","resolve","create","all","openTabs","scripting","executeScript","tabId","func","releaseItems","activeTab","sendSearchMessageToTab","search","searchInput","selectedValue","setupReleasesTab","popup","imageSrc","processBandcampReleasesData","processBandcampResponse","replaceVersion","manifest","callable","fn","refreshStatus","size","bytesToSize","getBytesInUse"],"sourceRoot":""}